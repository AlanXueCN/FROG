(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[38],{

/***/ "../ac/ac-select/src/ActivityRunner.js":
/*!*********************************************!*\
  !*** ../ac/ac-select/src/ActivityRunner.js ***!
  \*********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"../node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var frog_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! frog-utils */ \"../frog-utils/src/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"../node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Highlighter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Highlighter */ \"../ac/ac-select/src/Highlighter.js\");\n/* harmony import */ var _ColorSelect__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ColorSelect */ \"../ac/ac-select/src/ColorSelect.js\");\n\n\n\n\n\n\nvar TextToColor = function TextToColor(text) {\n  var c = Number(text.toLowerCase().split('').reduce(function (acc, cur) {\n    return acc + cur.charCodeAt();\n  }, ''));\n  var obj = {\n    r: 90 + Math.floor(c % (166 * 166 * 166) / (166 * 166)),\n    g: 90 + Math.floor(c % (166 * 166) / 166),\n    b: 90 + c % 166\n  };\n  return 'rgb(' + obj.r + ',' + obj.g + ',' + obj.b + ')';\n};\n\nvar unicodeWordRegexp = new RegExp(\"\".concat(frog_utils__WEBPACK_IMPORTED_MODULE_1__[\"notUnicodeLetter\"], \"(\").concat(frog_utils__WEBPACK_IMPORTED_MODULE_1__[\"unicodeLetter\"], \"+)\").concat(frog_utils__WEBPACK_IMPORTED_MODULE_1__[\"notUnicodeLetter\"]), 'ui');\nvar unicodeWordRegexpBeg = new RegExp(\"^(\".concat(frog_utils__WEBPACK_IMPORTED_MODULE_1__[\"unicodeLetter\"], \"+)\").concat(frog_utils__WEBPACK_IMPORTED_MODULE_1__[\"notUnicodeLetter\"]), 'ui');\nvar unicodeWordRegexpEnd = new RegExp(\"\".concat(frog_utils__WEBPACK_IMPORTED_MODULE_1__[\"notUnicodeLetter\"], \"(\").concat(frog_utils__WEBPACK_IMPORTED_MODULE_1__[\"unicodeLetter\"], \"+)$\"), 'ui');\nvar unicodeWordRegexpBegEnd = new RegExp(\"^(\".concat(frog_utils__WEBPACK_IMPORTED_MODULE_1__[\"unicodeLetter\"], \"+)$\"), 'ui');\n\nvar ActivityRunner = function ActivityRunner(_ref) {\n  var activityData = _ref.activityData,\n      data = _ref.data,\n      dataFn = _ref.dataFn,\n      logger = _ref.logger;\n  var wordPhrases = activityData.config.wordPhrases && Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"compact\"])(activityData.config.wordPhrases.map(function (x) {\n    return x && x.trim().toLowerCase();\n  }));\n  var wordPhrasesRegExp = !Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"isEmpty\"])(wordPhrases) && new RegExp(wordPhrases.join('|'), 'gui');\n\n  var selectPenColor = function selectPenColor(color) {\n    return dataFn.objReplace(data.currentColor, color, 'currentColor');\n  };\n\n  var onClick = function onClick() {\n    var s = window.getSelection();\n\n    if (s.isCollapsed) {\n      s.modify('move', 'forward', 'character');\n      s.modify('move', 'backward', 'word');\n      s.modify('extend', 'forward', 'word');\n      var sStr = s.toString().trim().toLowerCase();\n      var c = -1;\n\n      if (wordPhrases && !Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"isEmpty\"])(wordPhrases)) {\n        do {\n          c += 1;\n          var wF = wordPhrases[c];\n\n          if (wF.includes(sStr)) {\n            var words = wF.split(' ');\n            var idx = words.indexOf(sStr);\n            Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"times\"])(idx + 1, function () {\n              return s.modify('move', 'backward', 'word');\n            });\n            Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"times\"])(words.length, function () {\n              return s.modify('extend', 'forward', 'word');\n            });\n            sStr = s.toString().trim().toLowerCase();\n            Object(lodash__WEBPACK_IMPORTED_MODULE_2__[\"times\"])(idx, function () {\n              return s.modify('move', 'forward', 'word');\n            });\n          }\n        } while (c < wordPhrases.length - 1 && sStr !== wordPhrases[c]);\n      }\n\n      s.modify('move', 'forward', 'character'); // clear selection\n\n      var sel = wordPhrasesRegExp && sStr.match(wordPhrasesRegExp) || sStr.match(unicodeWordRegexpBegEnd) || sStr.match(unicodeWordRegexpBeg) || sStr.match(unicodeWordRegexpEnd) || sStr.match(unicodeWordRegexp);\n      var selectedRaw = sel && (sel[1] || sel[0]);\n\n      if (!selectedRaw) {\n        return;\n      }\n\n      var selected = selectedRaw.toLowerCase().trim();\n\n      if (data['highlighted'][selected] === undefined) {\n        dataFn.objInsert({\n          color: activityData.config.multi ? TextToColor(selected) : data.currentColor\n        }, ['highlighted', selected]);\n        logger({\n          type: 'plus',\n          value: selected\n        });\n      } else {\n        dataFn.objDel(data['highlighted'][selected], ['highlighted', selected]);\n        logger({\n          type: 'minus',\n          value: selected\n        });\n      }\n    }\n  };\n\n  return react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](react__WEBPACK_IMPORTED_MODULE_0__[\"Fragment\"], null, activityData.config.chooseColor && react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](_ColorSelect__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n    data: data,\n    selectPenColor: selectPenColor\n  }), react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](\"div\", {\n    onClick: onClick,\n    style: {\n      height: '100%',\n      overflow: 'scroll',\n      display: 'flex',\n      flexDirection: 'column',\n      margin: '20px',\n      fontSize: '1.5em',\n      lineHeight: '150%',\n      fontFamily: 'serif',\n      whiteSpace: 'pre-wrap'\n    }\n  }, react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](_Highlighter__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n    searchWords: data['highlighted'],\n    textToHighlight: activityData.config ? activityData.config.title || '' : '',\n    highlightStyle: {\n      fontSize: 'xx-large',\n      cursor: 'help'\n    },\n    unhighlightStyle: {\n      fontSize: 'xx-large',\n      cursor: 'help'\n    }\n  }), react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](\"br\", null), activityData.config.text && react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](_Highlighter__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n    searchWords: data['highlighted'],\n    highlightStyle: {\n      cursor: 'help'\n    },\n    unhighlightStyle: {\n      cursor: 'help'\n    },\n    textToHighlight: activityData.config.text\n  })));\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (ActivityRunner);\n\n//# sourceURL=webpack:///../ac/ac-select/src/ActivityRunner.js?");

/***/ })

}]);